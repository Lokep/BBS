webpackJsonp([12],{"0VyQ":function(t,e){},pep4:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("27Su"),s={data:function(){return{dialogImageUrl:"",imageName:"",preViewVisible:!1,tagType:["primary","success","info","warning","danger"],offerTags:[],articleInfo:{title:"",tags:[],content:"",createAt:(new Date).toLocaleDateString(),author:a.a.GET()[0].userName,authorID:a.a.GET()[0].userID},alertTitle:"",isShowError:!1}},mounted:function(){this.changeTags()},methods:{selectTag:function(t){if(this.articleInfo.tags.length)this.showError("一次只能选择一个标签哦~");else{var e=this.offerTags.indexOf(t);this.articleInfo.tags.push(t),this.offerTags.splice(e,1)}},tagClose:function(t){this.offerTags.push(this.articleInfo.tags[0]),this.articleInfo.tags.splice(-1,1)},handleRemove:function(t,e){this.preViewVisible=!1},handlePreview:function(t){},handleProgress:function(t,e,i){},changeTags:function(){this.offerTags=[];var t=this;this.$axios.post("/api/editor/tags").then(function(e){t.offerTags=e.data,console.log(t.offerTags)}).catch(function(t){console.log(t)})},handleChange:function(t,e){this.dialogImageUrl=t.url,this.imageName=t.name,this.preViewVisible=!0},submitArticle:function(){var t=this;""==this.articleInfo.title?this.showError("标题不可以为空哦"):0==this.articleInfo.tags.length?this.showError("记得选标签哦"):this.articleInfo.content.length<=140?this.showError("文章内容不可以少于140个字哦"):(this.$refs.upload.submit(),this.$axios.post("/api/editor/content",this.articleInfo).then(function(e){console.log(e),t.$router.push("/")}).catch(function(t){console.log(t)}),console.log(this.articleInfo))},showError:function(t){this.isShowError=!0,this.alertTitle=t},hideError:function(){this.isShowError=!1,this.alertTitle=""}}},o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"editor"},[i("el-form",[i("div",{staticClass:"editor-upload"},[i("el-upload",{ref:"upload",staticClass:"upload-box",attrs:{drag:"","list-type":"picture-card","on-preview":t.handlePreview,"on-remove":t.handleRemove,"auto-upload":!1,"on-change":t.handleChange,"on-progress":t.handleProgress,name:"image",action:"/api/editor/images"}},[i("i",{staticClass:"el-icon-upload"}),t._v(" "),i("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),i("em",[t._v("点击上传")])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.preViewVisible,expression:"!preViewVisible"}],staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过500kb")])]),t._v(" "),i("img",{directives:[{name:"show",rawName:"v-show",value:t.preViewVisible,expression:"preViewVisible"}],staticClass:"pre-view",attrs:{src:t.dialogImageUrl,alt:""}}),t._v(" "),i("div",{staticClass:"el-upload__tip"},[t._v(t._s(t.imageName))])],1),t._v(" "),i("el-form-item",{staticClass:"editor-title",attrs:{label:"请输入标题"}},[i("el-input",{attrs:{placeholder:"请输入标题...",clearable:""},model:{value:t.articleInfo.title,callback:function(e){t.$set(t.articleInfo,"title",e)},expression:"articleInfo.title"}}),t._v(" "),i("div",{staticClass:"editor-title-tag"},t._l(t.articleInfo.tags,function(e,a){return i("el-tag",{key:e.topicName,attrs:{type:t.tagType[a],index:a,closable:""},on:{close:t.tagClose}},[t._v(t._s(e.topicName))])}),1)],1),t._v(" "),i("el-form-item",{staticClass:"editor-tag",attrs:{label:"添加标签"}},[i("div",{staticClass:"editor-tag-list inline ov"},t._l(t.offerTags,function(e,a){return i("el-tag",{key:e.topicName,attrs:{index:a,type:t.tagType[a],title:e.topicTitle},on:{click:function(i){return t.selectTag(e)}}},[t._v(t._s(e.topicName))])}),1),t._v(" "),i("el-button",{staticClass:"fr",attrs:{size:"small",type:"primary",icon:"el-icon-refresh"},on:{click:t.changeTags}},[t._v("换一换")])],1),t._v(" "),i("el-form-item",{staticClass:"editor-content",attrs:{label:"文章内容",prop:"content"}},[i("el-input",{attrs:{type:"textarea",autosize:"",placeholder:"请输入内容"},model:{value:t.articleInfo.content,callback:function(e){t.$set(t.articleInfo,"content",e)},expression:"articleInfo.content"}})],1),t._v(" "),i("el-button",{staticClass:"editor-submit",attrs:{type:"primary"},on:{click:t.submitArticle}},[i("i",{staticClass:"el-icon-edit"}),t._v(" 发布")])],1),t._v(" "),i("el-alert",{directives:[{name:"show",rawName:"v-show",value:t.isShowError,expression:"isShowError"}],staticClass:"showError",attrs:{title:t.alertTitle,type:"error","show-icon":""},on:{close:t.hideError}})],1)},staticRenderFns:[]};var r=i("C7Lr")(s,o,!1,function(t){i("0VyQ")},null,null);e.default=r.exports}});