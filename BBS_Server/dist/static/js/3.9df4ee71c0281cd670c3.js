webpackJsonp([3],{"7w8z":function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=s("27Su"),n={props:["isVisible","inputType"],data:function(){return{dialogVisible:this.isVisible,oldInfo:"",newInfo:"",userinfo:{}}},mounted:function(){var t=localStorage.getItem("USERINFO");t&&(t=JSON.parse(t),this.userinfo=t[0])},methods:{handleClose:function(t){this.$confirm("确认关闭？").then(function(i){t()}).catch(function(t){})},onConfirm:function(){switch(this.inputType){case"密码":this.updatePwd();break;case"手机号":this.updatePhone();break;default:this.updateEmail()}},onCancel:function(){this.oldInfo=this.newInfo="",this.dialogVisible=!1},updatePwd:function(){var t=this;this.$axios.post("/api/users/update_pwd",{id:this.userinfo.id,oldpwd:this.oldInfo,newpwd:this.newInfo}).then(function(i){"200"===i.data.code&&(t.$message({type:"success",message:i.data.message}),t.onCancel())})},updatePhone:function(){var t=this;this.$axios.post("/api/users/update_phone",{id:this.userinfo.id,oldphone:this.oldInfo,newphone:this.newInfo}).then(function(i){if("200"===i.data.code){t.$message({type:"success",message:i.data.message}),console.log(t.newInfo);var s=e.a.GET("USERINFO");s[0].phone=t.newInfo,e.a.SET(s),t.onCancel()}})},updateEmail:function(){var t=this;this.$axios.post("/api/users/update_email",{id:this.userinfo.id,oldemail:this.oldInfo,newemail:this.newInfo}).then(function(i){if("200"===i.data.code){t.$message({type:"success",message:i.data.message});var s=e.a.GET("USERINFO");s[0].email=t.newInfo,e.a.SET(s),t.onCancel()}})}},watch:{isVisible:function(t){this.dialogVisible=t},dialogVisible:function(t){this.$emit("on-visible-change",t)}}},o={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("el-dialog",{attrs:{title:"信息编辑",center:!0,visible:t.dialogVisible,width:"30%","before-close":t.handleClose},on:{"update:visible":function(i){t.dialogVisible=i}}},[s("el-form",{attrs:{"label-width":"80px","status-icon":""}},[s("el-form-item",{attrs:{label:"原"+t.inputType}},[s("el-input",{attrs:{placeholder:"请输入原始"+t.inputType},model:{value:t.oldInfo,callback:function(i){t.oldInfo="string"==typeof i?i.trim():i},expression:"oldInfo"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"新"+t.inputType}},[s("el-input",{attrs:{placeholder:"请输入新的"+t.inputType},model:{value:t.newInfo,callback:function(i){t.newInfo="string"==typeof i?i.trim():i},expression:"newInfo"}})],1)],1),t._v(" "),s("span",{staticClass:"dialog-footer edit-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:t.onCancel}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.onConfirm}},[t._v("确 定")])],1)],1)},staticRenderFns:[]};var a={data:function(){return{modalVisible:!1,inputType:"",confusion:{phone:"",email:""}}},components:{EditModal:s("C7Lr")(n,o,!1,function(t){s("tkif")},null,null).exports},methods:{modalEdit:function(t){this.modalVisible=!0,this.inputType=t},onVisibleChange:function(t){console.log(t),this.modalVisible=t},confusionPhone:function(t,i){i=i||4;var s=t.length,e=t.substring(3,s-i);return t.replace(e,"****")},confusionEmail:function(t,i){i=i||4;var s=t.length,e=t.split("@"),n="@"+e[e.length-1],o=e[0].substring(3,s-i);return e[0].replace(o,"****")+n}},mounted:function(){this.confusion.email=this.confusionEmail(e.a.GET("USERINFO")[0].email,4),this.confusion.phone=this.confusionPhone(e.a.GET("USERINFO")[0].phone,4)}},l={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"setting ov"},[t._m(0),t._v(" "),s("div",{staticClass:"setting-right fr"},[t._m(1),t._v(" "),t._m(2),t._v(" "),s("div",{staticClass:"setting-block setting-sub-block"},[s("h4",{staticClass:"setting-sub-title"},[t._v("密码")]),t._v(" "),s("span",{staticClass:"setting-desc"},[t._v("帐户设置/密码服务")]),t._v(" "),s("button",{staticClass:"fr setting-btn",on:{click:function(i){return t.modalEdit("密码")}}},[t._v("编辑")])]),t._v(" "),s("div",{staticClass:"setting-block setting-sub-block"},[s("h4",{staticClass:"setting-sub-title"},[t._v("绑定手机")]),t._v(" "),s("span",{staticClass:"setting-desc"},[t._v(t._s(t.confusion.phone))]),t._v(" "),s("button",{staticClass:"fr setting-btn",on:{click:function(i){return t.modalEdit("手机号")}}},[t._v("编辑")])]),t._v(" "),s("div",{staticClass:"setting-block setting-sub-block"},[s("h4",{staticClass:"setting-sub-title"},[t._v("绑定邮箱")]),t._v(" "),s("span",{staticClass:"setting-desc"},[t._v(t._s(t.confusion.email))]),t._v(" "),s("button",{staticClass:"fr setting-btn",on:{click:function(i){return t.modalEdit("邮箱")}}},[t._v("编辑")])])]),t._v(" "),s("EditModal",{attrs:{isVisible:t.modalVisible,inputType:t.inputType},on:{"on-visible-change":t.onVisibleChange}})],1)},staticRenderFns:[function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"setting-left fl"},[i("ul",[i("li",[i("img",{staticClass:"inline-middle",attrs:{src:s("RtuH")}}),this._v(" "),i("span",{staticClass:"inline-middle"},[this._v("账户与密码")])])])])},function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"setting-block"},[i("h3",{staticClass:"setting-title"},[this._v("帐户设置")]),this._v(" "),i("span",{staticClass:"setting-desc"},[this._v("帐户设置/密码服务")])])},function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"setting-block"},[i("h4",{staticClass:"setting-sub-title"},[this._v("帐户与密码")]),this._v(" "),i("span",{staticClass:"setting-desc"},[this._v("绑定手机和邮箱，并设置密码，帐号更安全注意：为保证帐号安全，需进行二次验证。")])])}]};var c=s("C7Lr")(a,l,!1,function(t){s("VKNr")},null,null);i.default=c.exports},VKNr:function(t,i){},tkif:function(t,i){}});